\section{Поточечная и равномерная сходимость}


Пусть $X$ - некое множество, $Y$ - $\mathbb{R}$ или $\mathbb{R}^n$ или вообще любое метрическое пространство.
Даны последовательность функций $f_n: X \to Y, n = 1, 2, \hdots$, и функция $f:X \to Y$.

\begin{definition}
    Последовательность функций сходится на $X$ к функции $f$, поточечно, если $\forall x \in X$ последовательность значений $f_n(x)$ сходится к $f$ при $n \to \infty$.
    \[\forall x \in X \quad f_n(x) \underset{n \to \infty}{\to} f(x)\]
\end{definition}

\begin{statement}
    Из непрерывной функций $f_n$ не всегда следует непрерывность функции $f$
    \begin{proof}
        Пусть $X = \left[0, 1\right]$, $f_n(x) = x^n$. Тогда $f_1(x) = x, f_2(x) = x^2, f_3(x) = x^3$ и так далее.
        В это случае    
        \[\underset{x \in \left[0, 1\right]}{\lim_{n \to \infty}} = \begin{cases}
            0 \ x < 1 \\ 
            1 \ x = 1
        \end{cases}\]
        Видно, что $f(x)$ разрывна, хотя все $f_n$ непрерывны.
    \end{proof}
\end{statement}

\begin{definition}
    Пусть $f_n: X \to \mathbb{R}$, $f:X \to \mathbb{R}$.\\
    Последовательность $f_n$ сходится к $f$ \textbf{равномерно} на множестве $X$, если 
    \begin{equation}
        \label{uniform_convergence}
        \underset{x \in X}{\sup} \left|f_n(x) - f(x)\right| \underset{n \to \infty}{\to} 0
    \end{equation}

    \par
    "Оригинальное"  определение равномерной сходимости:
    
    \begin{equation}
        \label{original_uniform_convergence}
        \forall \varepsilon > 0 \ \exists n_0 \mid \forall x \in X \ \forall n \geq n_0 \quad \left| f_n(x) - f(x) \right| \leq \varepsilon
    \end{equation}

    \begin{proof}
        Докажем эквивалентность двух определений:\par
        \eqref{uniform_convergence} $\implies$ \eqref{original_uniform_convergence}:\\
        Пусть $\varepsilon > 0$, надо подобрать $n_0$. По условию \eqref{uniform_convergence}:
        \[\exists n_0 \mid \forall n \geq n_0 \quad \underset{x \in X}{\sup} \left| f_n(x) - f(x) \right| \leq \varepsilon\]
        Но $\forall x \in X \ \sup \geq \left| f_n(x) - f(x) \right|$, значит 
        \[\forall x \in X \ \left|f_n(x) - f(x) \right| \leq \sup \left| f_n(x) - f(x) \right| \leq \varepsilon\]
    \end{proof}
\end{definition}

\begin{definition}
    Последовательность $f_n(x)$ поточечно сходится к $f(x)$ при любых $x$, если 
    \[\forall \varepsilon > 0 \ \forall x \in X \ \exists n_0 \in \mathbb{N} \ \forall n \geq n_0 \ \left| f_n(x) - f(x)\right| \leq \varepsilon\]

    \par
    \eqref{original_uniform_convergence} $\implies$ \eqref{uniform_convergence}: Надо доказать, что $\forall \varepsilon \ \exists n_0 \mid \forall n \geq n_0 \ \underset{x \in X}{\sup} \left| f_n(x) - f(x) \right| \leq \varepsilon$.
    
    По условию \eqref{original_uniform_convergence}:
    \[\exists n_0 \mid \forall n \geq n_0 \ \forall x \in X \ \left| f_n(x) - f(x) \right| \leq \varepsilon \implies sup \left| f_n(x) - f(x) \right| \leq \varepsilon\]
\end{definition}

Равномерную сходимость $f_n(x)$ к $f(x)$ будем обозначать $f_n \underset{n \to \infty}{\rightrightarrows} f$


\begin{theorem}[Критерий отсутствия равномерной сходимости]
    $f_n$ не сходится равномерно к $f$ $\iff$ $\exists x_n \in X$ такая, что $f_n(x_n) - f(x_n) \nrightarrow 0$
\end{theorem}

\begin{theorem}[о пределе пределов]
    Пусть $X \subseteq \mathbb{R}$ (или $\forall$ метрического пространства). \\ Пусть $\begin{cases} f: X \to \mathbb{R} \\ f_n: X \to \mathbb{R} \end{cases}$, $p$ - предельная точка $X$.

    Предположим, что $f_n(x) \underset{x \to p}{\to} y_n$ и $y_n \underset{n \to \infty}{\to} y$. 
    Если $f_n$ \textbf{равномерно} сходится к $f$ ($f_n \rightrightarrows f$) на $X$, то $f(x) \to y$ при $x \to p$.
    \[\lim_{n \to \infty} (\lim_{x \to p} f_n(x)) = \lim_{x \to p}(\lim_{n \to \infty} f_n(x))\] 

    \begin{proof}
        Пусть $\varepsilon > 0$, надо доказать, что у точки $p$ имеется окрестность $U$, такая, что $\forall x \in X \cap U \ \left| f(x) - y \right| \leq \varepsilon$.
        \[\left| f(x) - y \right| = \left| f(x) - f_n(x) + f_n(x) - y_n + y_n - y \right| \leq \left| f(x) - f_n(x) \right| + \left| f_n(x) - y_n \right| + \left| y_n - y \right|\] 
        Рассмотрим каждое слагаемое в отдельности:\\
        1:
         \[\exists n_0 \mid \forall n \geq n_0 \quad \left| f(x) - f_n(x) \right| \leq \frac{\varepsilon}{3}\]
        
        3:
            \item \[\exists n_1 \mid \forall n \geq n_1 \quad \left| y_n - y \right| \leq \frac{\varepsilon}{3}\]
            Пусть $n_2 = \max{n_0, n_1}$. Тогда $\forall n \geq n_2$ выполнено и 1, и 3.\\
        2:
            \[f_{n_2}(x) \underset{x \to p}{\to} y_{n_2} \implies \exists U \text{ - окрестность точки $p$, такая, что } \forall x \in U \cap X \ \left| f_{n_2}(x) - y_{n_2} \right| \leq \frac{\varepsilon}{3}\]
        
        Для таких $x$ из $U \cap X$ выполнено:
        \[\left| f(x) - y\right| \leq \left| f(x) - f_{n_2}(x) \right| + \left| f_{n_2}(x) - y_{n_2} \right| + \left| y_{n_2} - y \right| \leq \frac{\varepsilon}{3} + \frac{\varepsilon}{3} + \frac{\varepsilon}{3} = \varepsilon\]
    \end{proof}
\end{theorem}

\begin{theorem*}[Следствие]
    Если все $f_n$ непрерывны в $p \in X$ и $f_n \rightrightarrows f$ на $X$, то $f$ тоже непрерывна в точке $p$.\\
    Нет, тот контрпример показывал, что просто непрерывности $f_n$ недостаточно, а следствие утверждает, что непрерывности + равномерной сходимости уже достаточно.
    \begin{proof}
        Надо показать, что $f(x) \underset{x \to p}{\to}f(p)$. Заметим, что $f_n(x) \to f(x)$ при $n \to \infty$ в силу обычной поточечной сходимости. Теперь по теореме:
        \[f(x) = \lim_{n \to \infty} f_n(x) \implies \lim_{x \to p} f(x) = \lim_{x \to p} (\lim_{n \to \infty} f_n(x)) \overset{\text{по теореме}}{=} \lim_{n \to \infty} (\lim_{x \to p} f_n(x)) = \lim_{n \to \infty} f_n(p) = f(p)\]
    \end{proof}

\end{theorem*}

\begin{theorem*}[Еще одно следствие]
    Если все $f_n$ непрерывны \textbf{на $X$} и $f_n \rightrightarrows$, то $f$ тоже непрерывна на $X$.
    \begin{proof}
        Нечего тут доказывать: определение непрерывности в точке расширяем до определения непрерывности на множестве.
    \end{proof}
\end{theorem*}

\begin{theorem*}[Критерий Коши равномерной сходимости последовательности функций]
    Пусть $X$ - множество, $f_n: X \to \mathbb{R}$. 
    \[\exists \text{функция } f: X \to \mathbb{R} \text{ такая, что } f_n \rightrightarrows f \text{ на $X$} \implies \forall \varepsilon \ \exists n_0 \mid \begin{array}{c} \forall x \in X \\ \forall k, l \geq n_0\end{array} \ \left| f_k(x) - f_l(x) \right| \leq \varepsilon\]

    \begin{proof}
        "$\impliedby$":\par
        Пусть $x \in X$. Тогда для числовой последовательности $f_n(x)$ выполнен обычный критерий Коши сходимости последовательности, поэтому $\exists \lim_{n \to \infty}f_n(x) =:f(x)$ (обозначим $f(x)$ равной этому пределу).
        \\
        Осталось показать, что $f_n$ сходится к $f$ равномерно. Пусть $\varepsilon > 0$. По условию Коши выполнено:
        \[\exists n_0 \mid \forall k, l \geq n_0 \ \left| f_k(x) - f_l(x) \right| \leq \varepsilon\]
        С помощью поточечной сходимости $f_l$ к $f_x$ можем перейти к пределу по $l \to \infty$:
        \[\forall x \in X \ \forall k \geq n_0 \ \left| f_k(x) - f(x) \right| \leq \varepsilon\]
        "$\impliedby$" доказано.

        "$\implies$": \par
        Пусть $\varepsilon > 0$. По условию \[\exists k \geq n_0 \ \forall x \in X \left| f_k(x) - f(x) \right| \leq \frac{\varepsilon}{2}\]
        Имеем: если $k, l \geq n_0$, то $\forall x$ выполнено:
        \[\left| f_k(x) - f_l(x) \right| \leq \left| f_k(x) - f(x) \right| + \left| f(x) - f_l(x) \right| \leq \frac{\varepsilon}{2} + \frac{\varepsilon}{2} = \varepsilon\]

    \end{proof}
\end{theorem*}

\begin{statement*}[Следствие]
    Пространство непрерывных функций на множестве $\left[a, b\right] \subset \mathbb{R}$ полно в $\sup$-норме. $C(x)$ - множество непрерывных функций на $x = \left[a, b\right] \to \mathbb{R}$, $\parallel f  \parallel_c  = \underset{x \in X}{\sup}$
    \begin{proof}
        Полнота: если последовательность функций удовлетворяет критерию Коши, то есть предел $f_n \to f$ в $\sup$-норме $\implies \underset{x \in X}{\sup} \left| f_n(x) - f(x) \right| \underset{n \to \infty}{\to} 0$.\\
        Условие Коши для последовательностей $f_n \in C\left[a, b\right]$ как раз и означает, что $f_n \rightrightarrows f$ - какой-то функции. Функции $f_n$ непрерывны и $\rightrightarrows f \implies f \in C\left[a, b\right]$

    \end{proof}
\end{statement*}

\begin{theorem*}[Дини]
    Пусть $X$ - компакт, $f_n: X \to \mathbb{R}, f:X \to \mathbb{R}, \ f_n, f \in C(X)$. \\
    Если $f_n$ сходится к $f$ на $X$ поточечно, то сходимость равномерна.

    \begin{proof}
        Ключ к доказательству: $\forall x$ последовательность $\left| f_n(x) - f(x) \right|$ монотонно убывет к $0$. \\
        Пусть $\varepsilon > 0$. Надо понять, что:
        \[\exists n_0 \mid \forall n \geq n_0 \ \forall x \in X \ \left| f_n(x) - f(x) \right| \leq \varepsilon\]
        Положим $U_n \subset X$, $U_n = \left\{ x \in X \mid \left| f_n(x) - f(x) \right| \right\} < \varepsilon$.
        \begin{enumerate}
            \item $\bigcup_{n=1}^{\infty} U_n = X$. В самом деле, $\forall x \forall n$ начиная с какого-то $n_0$ выполнено $\left| f_n(x) - f(x) \right|\leq \varepsilon$ (поточечная сходимость из условия) и $x \in U_n \ \forall n \geq n_0$.
            \item Все $U_n$ открыты в $X$ (по функциональному признаку - $\left| f_n(x) - f(x) \right|$ непрерывна и у нас есть неравенство).
            \item $X$ компактно $\implies$ существует конечное подпокрытие $U_{n_1} \cup \hdots \cup U_{n_k} = X$.
        \end{enumerate}
        Заметим, $U_n \subset U_{n+1}$, так как $\left| f_{n+1} - f(x) \right| \leq \left| f_n(x) - f(x) \right|$ в силу ключа.
        \[x \in U_n \implies \left| f_n(x) - f(x) \right| < \varepsilon\]
        Так как \[\left| f_n(x) - f(x) \right| \geq \left| f_{n+1}(x) - f(x) \right| \implies \text{ тоже $<\varepsilon$} \implies x \in U_{n+1}, U_{n+1} \supset U_n\]
        Значит, $\exists$ какое-то $n_0 \mid U_{n_0} = X$. Итак, $\forall x \left| f_{n_0}(x) - f(x) \right| < \varepsilon$ и для всех $n \geq n_0$ тоже.
    \end{proof}
\end{theorem*}


\subsection{Функциональные ряды}

\begin{definition}
    Функциональный ряд $\label{stand_func_series} \sum_{n = 1}^{\infty} f_n(x)$ сходится поточечно, если последовательность функций $S_n(x) = \sum_{k=1}^n f_k(x)$ сходится поточечно (т.е. сходится при $\forall x$).
    \par
    Ряд функций сходится на множестве $X$ равномерно к функции $f$, если $S_n \underset{n \to \infty}{\rightrightarrows} f$ на множестве $X$.
\end{definition}

\begin{theorem*}[Критерий Коши равномерной сходимости функционального ряда]
    Ряд $\eqref{stand_func_series}$ сходится равномерно тогда и только тогда, когда:
    \[\forall \varepsilon \ \exists n_0 \mid \forall k, l: l > k \geq n_0 \ \forall x\in X \ \left| \sum_{i=k}^{l} f_n(x) \right| < \varepsilon\]

    \begin{proof}
        Сумма $\sum_{k}^{l} f_k(x) = S_l(x) - S_{k-1}(x)$ - задача сведена к критерию Коши для последовательности фукнций частичных сумм (числовой последовательности).
    \end{proof}
\end{theorem*}

\begin{theorem*}[Признак сравнения]
    Пусть числовой ряд $\sum a_n$, где $a_n \geq 0$ сходится, если функции $f_n: X \to \mathbb{R}$ таковы, что $\underset{x \in X}{\sup} f_n(x) \leq a_n$ (эквивалентно $\forall x \in X \mid f_n(x) \leq a_n$).
    Тогда функциональный ряд $\sum f_n$ сходится на $X$ равномерно.

    \begin{proof}
        Покажем, что для ряда $\sum f_n$ выполнено условие Коши:\\
        Пусть $\varepsilon > 0$. Ряд $\sum a_n$ сходится $\implies$ для этого числового ряда выполнено условие Коши числовых рядов:
        \[\exists n_0 \forall k > l \geq n_0 \ \left| \sum_{m=k}^{l} a_m\right| \leq \varepsilon\]
        Тогда $\forall x \in X$ имеем:
        \[\left| \sum_{m=k}^{l} f_m(x)\right| \leq \sum_{m=k}^{l} \left| f_m(x) \right| \leq \sum_{m=k}^{l}a_m \leq \varepsilon\]
        Значит условие Коши выполнено для функционального ряда $\implies$ он сходится равномерно.
    \end{proof}      
\end{theorem*}

\begin{theorem*}[Необходимое условие равномерной сходимости функционального ряда]
    Ряд $\sum f_n$ сходится на множестве $X$ равномерно $\implies$ $\underset{x \in X}{\sup} \left| f_n(x) \right| \underset{n \to \infty}{\to} 0$
    \begin{proof}
        \[\underset{x \in X}{\sup} \left| f_n(x) \right| = \underset{x \in X}{\sup} \left| \sum_{m=n}^{n} f_n(x) \right|\]
        По условию Коши это стремится к $0$ при $n \to \infty$.
    \end{proof}
\end{theorem*}

\begin{statement*}
    Пусть ряд $S(x) = \sum f_n(x)$ равномерно сходится на $X$. Если все $f_n$ непрерывны, то $f$ - непрерывна.
    \begin{proof}
        Все $S_n(x) = (f_1(x) + \hdots + f_n(x))$ - непрерывные функции. $S_n \rightrightarrows f$ и применяем теорему о непрерывности предельной функции для последовательности (теорема о пределе пределов).
    \end{proof}
\end{statement*}

\begin{theorem*}[об интеграле]
    Пусть $(a, b)$ - ограниченный промежуток, $f_n$ - интегрируемые на $(a,b)$ функции.\\
    Если последовательность $f_n$ равномерно сходится на $(a,b)$, то последовательность $\int_{a}^{b} f_n$ сходится. Если при этом предельная функция $f$ ($f_n \rightrightarrows f$) интегрируема, то $\int_{a}^{b} f_n \underset{n \to \infty}{\to} \int_{a}^{b} f$.
    \begin{proof}
        Используем критерий Коши:\\
        Пусть $\varepsilon > 0$, тогда $\exists n_0 \mid \forall k,l \geq n_0$ выполнено:
        \[\underset{x \in (a,b)}{\sup} \left| f_k(x) - f_l(x) \right| \leq \frac{\varepsilon}{\left| a- b \right|}\]
        Для таких $k$ и $l$ выполнено:
        \[\left| \int_{a}^{b} f_k(x) - \int_{a}^{b} f_l(x) \right| = \left| \int_{a}^{b} f_k(x) - f_l(x) \right| \leq \int_{a}^{b} \left| f_k(x) - f_l(x) \right| \leq \int_{a}^{b} \frac{\varepsilon}{b-a} = \varepsilon\]
        То есть для числовой последовательности $\int_{a}^{b} f_n(x)$ выполнено условие Коши и она имеет предел.

        \par
        Если $f_n \rightrightarrows f$ интегрируема, то ясно, что $\int_{a}^{b} f_n - \int_{a}^{b} f \underset{n \to \infty}{\to} 0$. Важно, что $(a, b)$ ограничен.
    \end{proof}
\end{theorem*}

\subsection{Дифференциирование}
\begin{theorem}
    Пусть ограниченный отрезок $(a,b) \subset \mathbb{R}$ и $f_n$ дифференцируемы на $(a,b)$ и таковы, что 
    \begin{enumerate}
        \item $f'_n \underset{n \to \infty}{\rightrightarrows} h$ на $(a,b)$.
        \item $\exists p \in (a,b)$ такая, что последовательность $f_n(p)$ сходится.
    \end{enumerate}
    Тогда $\exists$ функция $f$ (дифференцируема на $(a,b)$) и такая, что $f_n \rightrightarrows f$ и $f' = h$.
    \par
    Теорема утверждает, что предел производных последовательности функций равен производной предела.

    \begin{proof}
        Положим $g_n(x) = \frac{f_n(x) - f_n(p)}{x-p}$, область определения $g_n$ это промежуток $(a,b) \backslash \{p\}$.\\
        Покажем, что последовательность $g_n$ равномерно сходится на своей области определения:\\
        Применим критерий Коши:
        \[g_k(x) - g_l(x) = \frac{(f_k(x) - f_l(x)) - (f_k(p) - f_l(p))}{x-p}, \text{ обозначим } f_{kl}(x) = f_k(x) - f_l(x), f_{kl}(p) = f_k(p) - f_l(p)\]
        Пусть $\varepsilon > 0$, имеем: 
        \[\exists n_0 \mid \forall k,l \geq n_0 \ \underset{x \in (a,b)}{\sup} \left| f'_k(x) - f'_l(x) \right| \leq \varepsilon, \text{ то есть, } \left| f'_{kl}(x) \right| \leq \varepsilon\]
        Тогда по теореме о среднем (теорема о приращениях):
        \[\forall x \left| f_{kl}(x) - f_{kl}(p) \right| \leq \varepsilon \cdot \left| x - p \right|\]
        Значит 
        \[g_k(x) - g_l(x) \leq \varepsilon \ \forall x \in (a,b)\{p\} \ \forall k,l \geq n_0\]
        Согласно критерию Коши последовательность функций $g_n$ сходится равномерно к $g$. Покажем, что $f_n(x)$ равномерно сходится.
        \[f_n(x) = g_n(x)(x-p) + f_n(p) \ \forall x \neq p\]
        Так как $g_n \rightrightarrows g$ и $f_n(x) \rightrightarrows f(x)$, то можем определить $f(x):=g(x)(x-p) + f_n(p)$.
        \textbf{УТОЧНИТЬ ДЕЙСТВИТЕЛЬНО ЛИ МЫ ВЫЧИТАЕМ $f(x)$}
        \[f_n(x) - f(x) = \left[g_n(x) - g(x)\right](x-p) + f_n(p) - f(x)\]
        Применим условие Коши к обоим слагаемым: пусть $\varepsilon > 0$, тогда
        \[\exists n_0 \mid \forall k,l \geq n_0 \ \left| g_k(x) -g_l(x) \right| \leq \frac{\varepsilon}{2(a-b)}\]
        и 
        \[(f_l(x) - f_l(p)) - (f_k(x) - f_k(p)) \leq \frac{\varepsilon}{2}\]
        Тогда 
        \[\left| f_l(x) - f_k(x) \right| \leq \frac{\varepsilon(x-p)}{2(b-a)} + \frac{\varepsilon}{2} \leq \varepsilon\]
        Итак, $f_n \rightrightarrows f$ на области определения.
        \par
        \[\lim_{n \to \infty} \lim_{x \to p}g_n(x) = \lim_{x \to p}\lim_{n \to \infty} g_n(x) \text{ по теореме о пределе пределов}\]
        Заметим, что 
        \[g_n(x) = \frac{f_n(x) - f_n(p)}{x-p} \implies \lim_{n \to \infty} \lim_{x \to p}g_n(x) = \lim_{n\to \infty} f'_n(p)\] 
        \[\lim_{x \to p}\lim_{n \to \infty}g_n(x) = \lim_{x \to p}\frac{f(x) - f(p)}{x-p} = f'(p)\]
        Эти пределы равны по теореме о пределе пределов, значит $\lim_{n \to \infty}f'_n(p) = f'(p)$.
    \end{proof}
\end{theorem}

\begin{statement*}[Следствие 1]
    Пусть ряд $\sum f_n$ сходится равномерно на ограниченном промежутке $(a,b)$.\\
    Если $f_n$ интегрируема и $f$ ($f = \sum f_n$) интгерируема, то 
    \[\int_{a}^{b} f = \int_{a}^{b} \sum f_n = \sum \int_{a}^{b} f_n\]
    \begin{proof}
        Сумма $\sum f_n$ - это предел частичных сумм $S_n(x) = \sum_{k = 1}^{n}f_k(x)$, $S_n(x) \rightrightarrows f$ и применяем теорему об интеграле.
    \end{proof}
\end{statement*}

\begin{statement*}[Следствие 2]
    Пусть ряд $\sum f_n(x)$ сходится хотя бы в одной точке $p \in (a,b)$ и ряд производных $\sum_{n=1}^{\infty} f'_n(x)$ сходится равномерно на $(a,b)$.\\
    Тогда исходный ряд сходится равномерно на всем $(a,b)$, а его сумма дифференцируема на $(a,b)$, и $(\sum f_n)' = \sum (f'_n)$.
    \begin{proof}
        Теорема о дифференцируемости, примененная к частичным суммам.
    \end{proof}
\end{statement*}

Далее будем рассматривать степенной ряд $f(x) = \sum_{n=1}^{\infty} C_n x^n$.

\begin{theorem}[Формула Коши-Адамара]
    Радиус сходимости степенного ряда можно вычислить по формуле Коши-Адамара:
    \[R = \frac{1}{{\overline{\lim}}_{n\to \infty} \sqrt[n]{\left| C_n \right|}}\]
    \begin{itemize}
        \item При $\left| x \right| < R$ - сходится.
        \item При $\left| x \right| > R$ - расходится.
        \item При $\left| x \right| = R$ - нужно более тонкое исследование.        
    \end{itemize}

    \begin{proof}
        Доказывается признаком Коши (в лекциях по ТФКП должно быть).
    \end{proof}
\end{theorem}

\begin{theorem*}
    Степенной ряд на внутренности круга сходимости можно интегрировать и дифференциировать почленно, при этом его сумма бесконечно дифференциируема в этой внутренности.

    \begin{proof}
        На подлете.
    \end{proof}
\end{theorem*}